#!/bin/bash
set -e

echo "Installing/updating codebuff via npm..."

# Install or update codebuff globally
# Always updates on installation, as mentioned in the issue
npm install -g codebuff

# Run codebuff --version to trigger download of extra files at install time
# Use || true to prevent installation failure if initialization has issues
echo "Initializing codebuff..."
NPM_BIN_PATH=$(npm config get prefix)/bin
"$NPM_BIN_PATH/codebuff" --version || true

echo "codebuff installation/update complete."

exit 0
